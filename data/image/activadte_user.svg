<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="847px" preserveAspectRatio="none" style="width:826px;height:847px;" version="1.1" viewBox="0 0 826 847" width="826px" zoomAndPan="magnify"><defs><filter height="300%" id="fvis1w9tyepz7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="231" x2="231" y1="87.6094" y2="758.6406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="455.5" x2="455.5" y1="87.6094" y2="758.6406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="597.5" x2="597.5" y1="87.6094" y2="758.6406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="717.5" x2="717.5" y1="87.6094" y2="758.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="214" y="84.5332">User</text><ellipse cx="231.5" cy="13" fill="#FEFECE" filter="url(#fvis1w9tyepz7)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M231.5,21 L231.5,48 M218.5,29 L244.5,29 M231.5,48 L218.5,63 M231.5,48 L244.5,63 " fill="none" filter="url(#fvis1w9tyepz7)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="214" y="772.1738">User</text><ellipse cx="231.5" cy="785.25" fill="#FEFECE" filter="url(#fvis1w9tyepz7)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M231.5,793.25 L231.5,820.25 M218.5,801.25 L244.5,801.25 M231.5,820.25 L218.5,835.25 M231.5,820.25 L244.5,835.25 " fill="none" filter="url(#fvis1w9tyepz7)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fvis1w9tyepz7)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="392.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="399.5" y="72.5332">Authorize service</text><rect fill="#FEFECE" filter="url(#fvis1w9tyepz7)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="392.5" y="757.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="399.5" y="779.1738">Authorize service</text><rect fill="#FEFECE" filter="url(#fvis1w9tyepz7)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="549.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="556.5" y="72.5332">OTP service</text><rect fill="#FEFECE" filter="url(#fvis1w9tyepz7)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="549.5" y="757.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="556.5" y="779.1738">OTP service</text><rect fill="#FEFECE" filter="url(#fvis1w9tyepz7)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="655.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="662.5" y="72.5332">Activadte service</text><rect fill="#FEFECE" filter="url(#fvis1w9tyepz7)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="655.5" y="757.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="662.5" y="779.1738">Activadte service</text><rect fill="#EEEEEE" filter="url(#fvis1w9tyepz7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="811" x="3" y="118.7852"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="814" y1="118.7852" y2="118.7852"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="814" y1="121.7852" y2="121.7852"/><rect fill="#EEEEEE" filter="url(#fvis1w9tyepz7)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="79" x="369" y="107.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="375" y="125.1045">Authorize</text><polygon fill="#A80036" points="443.5,165.3125,453.5,169.3125,443.5,173.3125,447.5,169.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="231.5" x2="449.5" y1="169.3125" y2="169.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="238.5" y="164.4561">Authentication Request</text><path d="M8,146.9609 L8,172.9609 L223,172.9609 L223,156.9609 L213,146.9609 L8,146.9609 " fill="#FBFB77" filter="url(#fvis1w9tyepz7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M213,146.9609 L213,156.9609 L223,156.9609 L213,146.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="14" y="165.4561">ใช้ user ที่ยังไม่ได้ผ่านการ activate</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="455.5" x2="497.5" y1="221.0156" y2="221.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="497.5" x2="497.5" y1="221.0156" y2="234.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468.5" x2="497.5" y1="234.0156" y2="234.0156"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="461.5" x2="471.5" y1="229.0156" y2="239.0156"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="461.5" x2="471.5" y1="239.0156" y2="229.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="462.5" y="199.8076">Check user is activate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="462.5" y="216.1592">activate=false</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="237.5" x2="247.5" y1="259.3672" y2="269.3672"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="237.5" x2="247.5" y1="269.3672" y2="259.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="243.5" x2="454.5" y1="264.3672" y2="264.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="248.5" y="259.5107">403 Error authentication Response</text><rect fill="#EEEEEE" filter="url(#fvis1w9tyepz7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="811" x="3" y="293.543"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="814" y1="293.543" y2="293.543"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="814" y1="296.543" y2="296.543"/><rect fill="#EEEEEE" filter="url(#fvis1w9tyepz7)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="101" x="358" y="282.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="364" y="299.8623">Activate User</text><polygon fill="#A80036" points="585.5,335.0703,595.5,339.0703,585.5,343.0703,589.5,339.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="231.5" x2="591.5" y1="339.0703" y2="339.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="238.5" y="334.2139">Request with ADMIN token</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="597.5" x2="639.5" y1="385.7734" y2="385.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="639.5" x2="639.5" y1="385.7734" y2="398.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="598.5" x2="639.5" y1="398.7734" y2="398.7734"/><polygon fill="#A80036" points="608.5,394.7734,598.5,398.7734,608.5,402.7734,604.5,398.7734" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="604.5" y="364.5654">Generate OTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="608.5" y="380.917">with individal key.</text><polygon fill="#A80036" points="242.5,425.125,232.5,429.125,242.5,433.125,238.5,429.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="236.5" x2="596.5" y1="429.125" y2="429.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="248.5" y="424.2686">OTP number Response</text><polygon fill="#A80036" points="706,455.4766,716,459.4766,706,463.4766,710,459.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="231.5" x2="712" y1="459.4766" y2="459.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="238.5" y="454.6201">Authentication with otp</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="718" x2="760" y1="506.1797" y2="506.1797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="760" x2="760" y1="506.1797" y2="519.1797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="719" x2="760" y1="519.1797" y2="519.1797"/><polygon fill="#A80036" points="729,515.1797,719,519.1797,729,523.1797,725,519.1797" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="725" y="484.9717">Set user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="725" y="501.3232">activate = true</text><polygon fill="#A80036" points="242.5,558.707,232.5,562.707,242.5,566.707,238.5,562.707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="236.5" x2="717" y1="562.707" y2="562.707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="248.5" y="557.8506">Another authentication Response</text><path d="M13,532.1797 L13,574.1797 L222,574.1797 L222,542.1797 L212,532.1797 L13,532.1797 " fill="#FBFB77" filter="url(#fvis1w9tyepz7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M212,532.1797 L212,542.1797 L222,542.1797 L212,532.1797 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="19" y="550.6748">User ที่ผ่านการ activate แล้ว</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="19" y="567.0264">ครั้งหน้าสามารถ Authorize ได้เลย</text><rect fill="#EEEEEE" filter="url(#fvis1w9tyepz7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="811" x="3" y="605.0586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="814" y1="605.0586" y2="605.0586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="814" y1="608.0586" y2="608.0586"/><rect fill="#EEEEEE" filter="url(#fvis1w9tyepz7)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="79" x="369" y="593.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="375" y="611.3779">Authorize</text><polygon fill="#A80036" points="443.5,646.5859,453.5,650.5859,443.5,654.5859,447.5,650.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="231.5" x2="449.5" y1="650.5859" y2="650.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="238.5" y="645.7295">Authentication Request</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="455.5" x2="497.5" y1="697.2891" y2="697.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="497.5" x2="497.5" y1="697.2891" y2="710.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456.5" x2="497.5" y1="710.2891" y2="710.2891"/><polygon fill="#A80036" points="466.5,706.2891,456.5,710.2891,466.5,714.2891,462.5,710.2891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="462.5" y="676.0811">Check user is activate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="462.5" y="692.4326">activate=true</text><polygon fill="#A80036" points="242.5,736.6406,232.5,740.6406,242.5,744.6406,238.5,740.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="236.5" x2="454.5" y1="740.6406" y2="740.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="248.5" y="735.7842">Another authentication Response</text><!--MD5=[afb836d2f594dd3e8574b73295393722]
@startuml
actor User

== Authorize ==
User -> "Authorize service": Authentication Request
note left: ใช้ user ที่ยังไม่ได้ผ่านการ activate
"Authorize service" ->x "Authorize service": Check user is activate\nactivate=false
User x<- - "Authorize service": 403 Error authentication Response

== Activate User ==
User -> "OTP service": Request with ADMIN token
"OTP service" -> "OTP service": Generate OTP\n with individal key.
"OTP service" - -> User: OTP number Response
User -> "Activadte service": Authentication with otp
"Activadte service" -> "Activadte service" : Set user\nactivate = true
User <- - "Activadte service": Another authentication Response

== Authorize ==
note left: User ที่ผ่านการ activate แล้ว\nครั้งหน้าสามารถ Authorize ได้เลย
User - -> "Authorize service": Authentication Request
"Authorize service" -> "Authorize service": Check user is activate\nactivate=true
User <- - "Authorize service": Another authentication Response

@enduml

PlantUML version 1.2019.12(Sun Nov 03 17:24:54 ICT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_181-b13
Operating System: Windows 10
Default Encoding: MS874
Language: th
Country: TH
--></g></svg>